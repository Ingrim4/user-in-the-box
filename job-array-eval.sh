#!/bin/bash
#SBATCH --job-name=uitb-array-eval
#SBATCH --nodes=1
#SBATCH --ntasks=1
#SBATCH --gpus-per-task=1
#SBATCH --cpus-per-task=4
#SBATCH --mem=16G
#SBATCH --array=0-179
#SBATCH --partition=paula
#SBATCH --time=00:05:00
#SBATCH -o logs/%x-%A/out.%a.log
#SBATCH -e logs/%x-%A/err.%a.log

module load Anaconda3
module load Mesa/23.1.9-GCCcore-13.2.0

export MUJOCO_GL=egl
export WANDB_MODE=disabled

source activate uitb

CONFIGS=(
    "mirror_09_001__x__35__abs__zero"
    "mirror_09_002__x__35__abs__ejk_2_0"
    "mirror_09_003__x__35__abs__ejk_1_0"
    "mirror_09_004__x__35__abs__jac_0_1"
    "mirror_09_005__x__35__abs__jac_0_05"
    "mirror_09_006__x__35__abs__dc_0_1"
    "mirror_09_007__x__35__abs__dc_0_05"
    "mirror_09_008__x__35__abs__ctc_0_0025"
    "mirror_09_009__x__35__abs__ctc_0_001"
    "mirror_09_010__x__35__abs_bonus_0_375__zero"
    "mirror_09_011__x__35__abs_bonus_0_375__ejk_2_0"
    "mirror_09_012__x__35__abs_bonus_0_375__ejk_1_0"
    "mirror_09_013__x__35__abs_bonus_0_375__jac_0_1"
    "mirror_09_014__x__35__abs_bonus_0_375__jac_0_05"
    "mirror_09_015__x__35__abs_bonus_0_375__dc_0_1"
    "mirror_09_016__x__35__abs_bonus_0_375__dc_0_05"
    "mirror_09_017__x__35__abs_bonus_0_375__ctc_0_0025"
    "mirror_09_018__x__35__abs_bonus_0_375__ctc_0_001"
    "mirror_09_046__xz__35__abs__zero"
    "mirror_09_047__xz__35__abs__ejk_2_0"
    "mirror_09_048__xz__35__abs__ejk_1_0"
    "mirror_09_049__xz__35__abs__jac_0_1"
    "mirror_09_050__xz__35__abs__jac_0_05"
    "mirror_09_051__xz__35__abs__dc_0_1"
    "mirror_09_052__xz__35__abs__dc_0_05"
    "mirror_09_053__xz__35__abs__ctc_0_0025"
    "mirror_09_054__xz__35__abs__ctc_0_001"
    "mirror_09_055__xz__35__abs_bonus_0_375__zero"
    "mirror_09_056__xz__35__abs_bonus_0_375__ejk_2_0"
    "mirror_09_057__xz__35__abs_bonus_0_375__ejk_1_0"
    "mirror_09_058__xz__35__abs_bonus_0_375__jac_0_1"
    "mirror_09_059__xz__35__abs_bonus_0_375__jac_0_05"
    "mirror_09_060__xz__35__abs_bonus_0_375__dc_0_1"
    "mirror_09_061__xz__35__abs_bonus_0_375__dc_0_05"
    "mirror_09_062__xz__35__abs_bonus_0_375__ctc_0_0025"
    "mirror_09_063__xz__35__abs_bonus_0_375__ctc_0_001"
    "mirror_09_091__xy__35__abs__zero"
    "mirror_09_092__xy__35__abs__ejk_2_0"
    "mirror_09_093__xy__35__abs__ejk_1_0"
    "mirror_09_094__xy__35__abs__jac_0_1"
    "mirror_09_095__xy__35__abs__jac_0_05"
    "mirror_09_096__xy__35__abs__dc_0_1"
    "mirror_09_097__xy__35__abs__dc_0_05"
    "mirror_09_098__xy__35__abs__ctc_0_0025"
    "mirror_09_099__xy__35__abs__ctc_0_001"
    "mirror_09_100__xy__35__abs_bonus_0_375__zero"
    "mirror_09_101__xy__35__abs_bonus_0_375__ejk_2_0"
    "mirror_09_102__xy__35__abs_bonus_0_375__ejk_1_0"
    "mirror_09_103__xy__35__abs_bonus_0_375__jac_0_1"
    "mirror_09_104__xy__35__abs_bonus_0_375__jac_0_05"
    "mirror_09_105__xy__35__abs_bonus_0_375__dc_0_1"
    "mirror_09_106__xy__35__abs_bonus_0_375__dc_0_05"
    "mirror_09_107__xy__35__abs_bonus_0_375__ctc_0_0025"
    "mirror_09_108__xy__35__abs_bonus_0_375__ctc_0_001"
    "mirror_09_136__xyz__35__abs__zero"
    "mirror_09_137__xyz__35__abs__ejk_2_0"
    "mirror_09_138__xyz__35__abs__ejk_1_0"
    "mirror_09_139__xyz__35__abs__jac_0_1"
    "mirror_09_140__xyz__35__abs__jac_0_05"
    "mirror_09_141__xyz__35__abs__dc_0_1"
    "mirror_09_142__xyz__35__abs__dc_0_05"
    "mirror_09_143__xyz__35__abs__ctc_0_0025"
    "mirror_09_144__xyz__35__abs__ctc_0_001"
    "mirror_09_145__xyz__35__abs_bonus_0_375__zero"
    "mirror_09_146__xyz__35__abs_bonus_0_375__ejk_2_0"
    "mirror_09_147__xyz__35__abs_bonus_0_375__ejk_1_0"
    "mirror_09_148__xyz__35__abs_bonus_0_375__jac_0_1"
    "mirror_09_149__xyz__35__abs_bonus_0_375__jac_0_05"
    "mirror_09_150__xyz__35__abs_bonus_0_375__dc_0_1"
    "mirror_09_151__xyz__35__abs_bonus_0_375__dc_0_05"
    "mirror_09_152__xyz__35__abs_bonus_0_375__ctc_0_0025"
    "mirror_09_153__xyz__35__abs_bonus_0_375__ctc_0_001"
    "mirror_09_019__x__35__exp__zero"
    "mirror_09_020__x__35__exp__ejk_2_0"
    "mirror_09_021__x__35__exp__ejk_1_0"
    "mirror_09_022__x__35__exp__jac_0_1"
    "mirror_09_023__x__35__exp__jac_0_05"
    "mirror_09_024__x__35__exp__dc_0_1"
    "mirror_09_025__x__35__exp__dc_0_05"
    "mirror_09_026__x__35__exp__ctc_0_0025"
    "mirror_09_027__x__35__exp__ctc_0_001"
    "mirror_09_028__x__35__exp_bonus_0_2__zero"
    "mirror_09_029__x__35__exp_bonus_0_2__ejk_2_0"
    "mirror_09_030__x__35__exp_bonus_0_2__ejk_1_0"
    "mirror_09_031__x__35__exp_bonus_0_2__jac_0_1"
    "mirror_09_032__x__35__exp_bonus_0_2__jac_0_05"
    "mirror_09_033__x__35__exp_bonus_0_2__dc_0_1"
    "mirror_09_034__x__35__exp_bonus_0_2__dc_0_05"
    "mirror_09_035__x__35__exp_bonus_0_2__ctc_0_0025"
    "mirror_09_036__x__35__exp_bonus_0_2__ctc_0_001"
    "mirror_09_064__xz__35__exp__zero"
    "mirror_09_065__xz__35__exp__ejk_2_0"
    "mirror_09_066__xz__35__exp__ejk_1_0"
    "mirror_09_067__xz__35__exp__jac_0_1"
    "mirror_09_068__xz__35__exp__jac_0_05"
    "mirror_09_069__xz__35__exp__dc_0_1"
    "mirror_09_070__xz__35__exp__dc_0_05"
    "mirror_09_071__xz__35__exp__ctc_0_0025"
    "mirror_09_072__xz__35__exp__ctc_0_001"
    "mirror_09_073__xz__35__exp_bonus_0_2__zero"
    "mirror_09_074__xz__35__exp_bonus_0_2__ejk_2_0"
    "mirror_09_075__xz__35__exp_bonus_0_2__ejk_1_0"
    "mirror_09_076__xz__35__exp_bonus_0_2__jac_0_1"
    "mirror_09_077__xz__35__exp_bonus_0_2__jac_0_05"
    "mirror_09_078__xz__35__exp_bonus_0_2__dc_0_1"
    "mirror_09_079__xz__35__exp_bonus_0_2__dc_0_05"
    "mirror_09_080__xz__35__exp_bonus_0_2__ctc_0_0025"
    "mirror_09_081__xz__35__exp_bonus_0_2__ctc_0_001"
    "mirror_09_109__xy__35__exp__zero"
    "mirror_09_110__xy__35__exp__ejk_2_0"
    "mirror_09_111__xy__35__exp__ejk_1_0"
    "mirror_09_112__xy__35__exp__jac_0_1"
    "mirror_09_113__xy__35__exp__jac_0_05"
    "mirror_09_114__xy__35__exp__dc_0_1"
    "mirror_09_115__xy__35__exp__dc_0_05"
    "mirror_09_116__xy__35__exp__ctc_0_0025"
    "mirror_09_117__xy__35__exp__ctc_0_001"
    "mirror_09_118__xy__35__exp_bonus_0_2__zero"
    "mirror_09_119__xy__35__exp_bonus_0_2__ejk_2_0"
    "mirror_09_120__xy__35__exp_bonus_0_2__ejk_1_0"
    "mirror_09_121__xy__35__exp_bonus_0_2__jac_0_1"
    "mirror_09_122__xy__35__exp_bonus_0_2__jac_0_05"
    "mirror_09_123__xy__35__exp_bonus_0_2__dc_0_1"
    "mirror_09_124__xy__35__exp_bonus_0_2__dc_0_05"
    "mirror_09_125__xy__35__exp_bonus_0_2__ctc_0_0025"
    "mirror_09_126__xy__35__exp_bonus_0_2__ctc_0_001"
    "mirror_09_154__xyz__35__exp__zero"
    "mirror_09_155__xyz__35__exp__ejk_2_0"
    "mirror_09_156__xyz__35__exp__ejk_1_0"
    "mirror_09_157__xyz__35__exp__jac_0_1"
    "mirror_09_158__xyz__35__exp__jac_0_05"
    "mirror_09_159__xyz__35__exp__dc_0_1"
    "mirror_09_160__xyz__35__exp__dc_0_05"
    "mirror_09_161__xyz__35__exp__ctc_0_0025"
    "mirror_09_162__xyz__35__exp__ctc_0_001"
    "mirror_09_163__xyz__35__exp_bonus_0_2__zero"
    "mirror_09_164__xyz__35__exp_bonus_0_2__ejk_2_0"
    "mirror_09_165__xyz__35__exp_bonus_0_2__ejk_1_0"
    "mirror_09_166__xyz__35__exp_bonus_0_2__jac_0_1"
    "mirror_09_167__xyz__35__exp_bonus_0_2__jac_0_05"
    "mirror_09_168__xyz__35__exp_bonus_0_2__dc_0_1"
    "mirror_09_169__xyz__35__exp_bonus_0_2__dc_0_05"
    "mirror_09_170__xyz__35__exp_bonus_0_2__ctc_0_0025"
    "mirror_09_171__xyz__35__exp_bonus_0_2__ctc_0_001"
    "mirror_09_037__x__35__bonus__zero"
    "mirror_09_038__x__35__bonus__ejk_2_0"
    "mirror_09_039__x__35__bonus__ejk_1_0"
    "mirror_09_040__x__35__bonus__jac_0_1"
    "mirror_09_041__x__35__bonus__jac_0_05"
    "mirror_09_042__x__35__bonus__dc_0_1"
    "mirror_09_043__x__35__bonus__dc_0_05"
    "mirror_09_044__x__35__bonus__ctc_0_0025"
    "mirror_09_045__x__35__bonus__ctc_0_001"
    "mirror_09_082__xz__35__bonus__zero"
    "mirror_09_083__xz__35__bonus__ejk_2_0"
    "mirror_09_084__xz__35__bonus__ejk_1_0"
    "mirror_09_085__xz__35__bonus__jac_0_1"
    "mirror_09_086__xz__35__bonus__jac_0_05"
    "mirror_09_087__xz__35__bonus__dc_0_1"
    "mirror_09_088__xz__35__bonus__dc_0_05"
    "mirror_09_089__xz__35__bonus__ctc_0_0025"
    "mirror_09_090__xz__35__bonus__ctc_0_001"
    "mirror_09_127__xy__35__bonus__zero"
    "mirror_09_128__xy__35__bonus__ejk_2_0"
    "mirror_09_129__xy__35__bonus__ejk_1_0"
    "mirror_09_130__xy__35__bonus__jac_0_1"
    "mirror_09_131__xy__35__bonus__jac_0_05"
    "mirror_09_132__xy__35__bonus__dc_0_1"
    "mirror_09_133__xy__35__bonus__dc_0_05"
    "mirror_09_134__xy__35__bonus__ctc_0_0025"
    "mirror_09_135__xy__35__bonus__ctc_0_001"
    "mirror_09_172__xyz__35__bonus__zero"
    "mirror_09_173__xyz__35__bonus__ejk_2_0"
    "mirror_09_174__xyz__35__bonus__ejk_1_0"
    "mirror_09_175__xyz__35__bonus__jac_0_1"
    "mirror_09_176__xyz__35__bonus__jac_0_05"
    "mirror_09_177__xyz__35__bonus__dc_0_1"
    "mirror_09_178__xyz__35__bonus__dc_0_05"
    "mirror_09_179__xyz__35__bonus__ctc_0_0025"
    "mirror_09_180__xyz__35__bonus__ctc_0_001"
)

if [ "$SLURM_ARRAY_TASK_ID" -ge "${#CONFIGS[@]}" ]; then
  echo "Error: SLURM_ARRAY_TASK_ID=$SLURM_ARRAY_TASK_ID is out of range (max index: $(( ${#CONFIGS[@]} - 1 )))"
  exit 1
fi

CONFIG=${CONFIGS[$SLURM_ARRAY_TASK_ID]}

conda run -n uitb python uitb/test/evaluator.py "simulators/$CONFIG" --num_episodes 1 --action_sample_freq 100 --record
